# Nextest configuration for faster parallel tests
# See https://nexte.st/book/configuration.html

[profile.default]
# Run more tests in parallel - safe since each test has isolated database
test-threads = "num-cpus"

# Longer timeout for e2e tests
slow-timeout = { period = "60s", terminate-after = 2 }

# Cap e2e/integration tests to 16 parallel threads to avoid PostgreSQL
# connection exhaustion. Each test uses ~4 pool connections (no admin
# connections), so 16 * 4 = 64, well under PG's default max_connections = 100.
[test-groups.e2e-db]
max-threads = 16

[[profile.default.overrides]]
filter = "package(api) & binary(/^e2e/)"
test-group = "e2e-db"
